<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="doc2go">
    <link href="../../../../_/css/main.css" rel="stylesheet" />
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../_/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../_/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../_/icons/favicon-16x16.png">
    <link rel="shortcut icon" href="../../../../_/icons/favicon.ico"><title>testutil</title>
</head>
  <body>
    <nav>
        <a href="../../..">go.astrophena.name</a>/<a href="../..">tools</a>/<a href="..">internal</a>/testutil<span class="navbar-right">
          <a href="../../../..">Root</a> | <a href="#pkg-index">Index</a></span>
      </nav>
    <main><h2 id="pkg-overview">package testutil</h2>
<pre class="chroma"><span class="kn">import</span> <span class="s">&#34;go.astrophena.name/tools/internal/testutil&#34;</span></pre>
<p>Package testutil contains common testing helpers.
<h3 id="pkg-index">Index</h3>
<ul>
  <li><a href="#AssertContains">func AssertContains(t *testing.T, s S, v V)</a></li>
  <li><a href="#AssertEqual">func AssertEqual(t *testing.T, got, want any)</a></li>
  <li><a href="#AssertNotContains">func AssertNotContains(t *testing.T, s S, v V)</a></li>
  <li><a href="#BuildTxtar">func BuildTxtar(t *testing.T, dir string) []byte</a></li>
  <li><a href="#ExtractTxtar">func ExtractTxtar(t *testing.T, ar *txtar.Archive, dir string)</a></li>
  <li><a href="#MockHTTPClient">func MockHTTPClient(t *testing.T, h http.Handler) *http.Client</a></li>
  <li><a href="#Run">func Run(t *testing.T, glob string, f func(t *testing.T, match string))</a></li>
  <li><a href="#RunGolden">func RunGolden(t *testing.T, glob string, f func(t *testing.T, match string) []byte, ...)</a></li>
  <li><a href="#UnmarshalJSON">func UnmarshalJSON(t *testing.T, b []byte) V</a></li>
  </ul><h3 id="pkg-functions">Functions</h3>
  <h3 id="AssertContains">func AssertContains</h3>
    <pre class="chroma"><span class="kd">func</span> <span class="nx">AssertContains</span><span class="p">[</span><span class="nx">S</span> <span class="p">~[]</span><span class="nx">V</span><span class="p">,</span> <span class="nx">V</span> <a href="https://pkg.go.dev/builtin#comparable"><span class="nx">comparable</span></a><span class="p">](</span><span class="nx">t</span> <span class="o">*</span><a href="https://pkg.go.dev/testing"><span class="nx">testing</span></a><span class="p">.</span><a href="https://pkg.go.dev/testing#T"><span class="nx">T</span></a><span class="p">,</span> <span class="nx">s</span> <span class="nx">S</span><span class="p">,</span> <span class="nx">v</span> <span class="nx">V</span><span class="p">)</span></pre>
    <p>AssertContains fails the test if v is not present in s.
<h3 id="AssertEqual">func AssertEqual</h3>
    <pre class="chroma"><span class="kd">func</span> <span class="nf">AssertEqual</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><a href="https://pkg.go.dev/testing"><span class="nx">testing</span></a><span class="p">.</span><a href="https://pkg.go.dev/testing#T"><span class="nx">T</span></a><span class="p">,</span> <span class="nx">got</span><span class="p">,</span> <span class="nx">want</span> <a href="https://pkg.go.dev/builtin#any"><span class="nx">any</span></a><span class="p">)</span></pre>
    <p>AssertEqual compares two values and if they differ, fails the test and
prints the difference between them.
<h3 id="AssertNotContains">func AssertNotContains</h3>
    <pre class="chroma"><span class="kd">func</span> <span class="nx">AssertNotContains</span><span class="p">[</span><span class="nx">S</span> <span class="p">~[]</span><span class="nx">V</span><span class="p">,</span> <span class="nx">V</span> <a href="https://pkg.go.dev/builtin#comparable"><span class="nx">comparable</span></a><span class="p">](</span><span class="nx">t</span> <span class="o">*</span><a href="https://pkg.go.dev/testing"><span class="nx">testing</span></a><span class="p">.</span><a href="https://pkg.go.dev/testing#T"><span class="nx">T</span></a><span class="p">,</span> <span class="nx">s</span> <span class="nx">S</span><span class="p">,</span> <span class="nx">v</span> <span class="nx">V</span><span class="p">)</span></pre>
    <p>AssertNotContains fails the test if v is present in s.
<h3 id="BuildTxtar">func BuildTxtar</h3>
    <pre class="chroma"><span class="kd">func</span> <span class="nf">BuildTxtar</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><a href="https://pkg.go.dev/testing"><span class="nx">testing</span></a><span class="p">.</span><a href="https://pkg.go.dev/testing#T"><span class="nx">T</span></a><span class="p">,</span> <span class="nx">dir</span> <a href="https://pkg.go.dev/builtin#string"><span class="kt">string</span></a><span class="p">)</span> <span class="p">[]</span><a href="https://pkg.go.dev/builtin#byte"><span class="kt">byte</span></a></pre>
    <p>BuildTxtar constructs a txtar archive from contents of dir.
<h3 id="ExtractTxtar">func ExtractTxtar</h3>
    <pre class="chroma"><span class="kd">func</span> <span class="nf">ExtractTxtar</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><a href="https://pkg.go.dev/testing"><span class="nx">testing</span></a><span class="p">.</span><a href="https://pkg.go.dev/testing#T"><span class="nx">T</span></a><span class="p">,</span> <span class="nx">ar</span> <span class="o">*</span><a href="../txtar"><span class="nx">txtar</span></a><span class="p">.</span><a href="../txtar#Archive"><span class="nx">Archive</span></a><span class="p">,</span> <span class="nx">dir</span> <a href="https://pkg.go.dev/builtin#string"><span class="kt">string</span></a><span class="p">)</span></pre>
    <p>ExtractTxtar extracts a txtar archive to dir.
<h3 id="MockHTTPClient">func MockHTTPClient</h3>
    <pre class="chroma"><span class="kd">func</span> <span class="nf">MockHTTPClient</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><a href="https://pkg.go.dev/testing"><span class="nx">testing</span></a><span class="p">.</span><a href="https://pkg.go.dev/testing#T"><span class="nx">T</span></a><span class="p">,</span> <span class="nx">h</span> <a href="https://pkg.go.dev/net/http"><span class="nx">http</span></a><span class="p">.</span><a href="https://pkg.go.dev/net/http#Handler"><span class="nx">Handler</span></a><span class="p">)</span> <span class="o">*</span><a href="https://pkg.go.dev/net/http"><span class="nx">http</span></a><span class="p">.</span><a href="https://pkg.go.dev/net/http#Client"><span class="nx">Client</span></a></pre>
    <p>MockHTTPClient returns a <a href="https://pkg.go.dev/net/http#Client">http.Client</a> that serves all requests made through
it from handler h.
<h3 id="Run">func Run</h3>
    <pre class="chroma"><span class="kd">func</span> <span class="nf">Run</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><a href="https://pkg.go.dev/testing"><span class="nx">testing</span></a><span class="p">.</span><a href="https://pkg.go.dev/testing#T"><span class="nx">T</span></a><span class="p">,</span> <span class="nx">glob</span> <a href="https://pkg.go.dev/builtin#string"><span class="kt">string</span></a><span class="p">,</span> <span class="nx">f</span> <span class="kd">func</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><a href="https://pkg.go.dev/testing"><span class="nx">testing</span></a><span class="p">.</span><a href="https://pkg.go.dev/testing#T"><span class="nx">T</span></a><span class="p">,</span> <span class="nx">match</span> <a href="https://pkg.go.dev/builtin#string"><span class="kt">string</span></a><span class="p">))</span></pre>
    <p>Run runs a subtest for each file matching the provided glob pattern.
<h3 id="RunGolden">func RunGolden</h3>
    <pre class="chroma"><span class="kd">func</span> <span class="nf">RunGolden</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><a href="https://pkg.go.dev/testing"><span class="nx">testing</span></a><span class="p">.</span><a href="https://pkg.go.dev/testing#T"><span class="nx">T</span></a><span class="p">,</span> <span class="nx">glob</span> <a href="https://pkg.go.dev/builtin#string"><span class="kt">string</span></a><span class="p">,</span> <span class="nx">f</span> <span class="kd">func</span><span class="p">(</span><span class="nx">t</span> <span class="o">*</span><a href="https://pkg.go.dev/testing"><span class="nx">testing</span></a><span class="p">.</span><a href="https://pkg.go.dev/testing#T"><span class="nx">T</span></a><span class="p">,</span> <span class="nx">match</span> <a href="https://pkg.go.dev/builtin#string"><span class="kt">string</span></a><span class="p">)</span> <span class="p">[]</span><a href="https://pkg.go.dev/builtin#byte"><span class="kt">byte</span></a><span class="p">,</span> <span class="nx">update</span> <a href="https://pkg.go.dev/builtin#bool"><span class="kt">bool</span></a><span class="p">)</span></pre>
    <p>RunGolden runs a subtest for each file matching the provided glob pattern,
computing the result and comparing it with a golden file, or updating a
golden file if update is true.
<p>f is a function that should compute the result and return it as a byte slice.
<h3 id="UnmarshalJSON">func UnmarshalJSON</h3>
    <pre class="chroma"><span class="kd">func</span> <span class="nx">UnmarshalJSON</span><span class="p">[</span><span class="nx">V</span> <a href="https://pkg.go.dev/builtin#any"><span class="nx">any</span></a><span class="p">](</span><span class="nx">t</span> <span class="o">*</span><a href="https://pkg.go.dev/testing"><span class="nx">testing</span></a><span class="p">.</span><a href="https://pkg.go.dev/testing#T"><span class="nx">T</span></a><span class="p">,</span> <span class="nx">b</span> <span class="p">[]</span><a href="https://pkg.go.dev/builtin#byte"><span class="kt">byte</span></a><span class="p">)</span> <span class="nx">V</span></pre>
    <p>UnmarshalJSON parses the JSON data into v, failing the test in case of failure.
</main>
    <hr>
    <footer>
      <small id="generated-by-footer">
        Generated with <a href="https://abhinav.github.io/doc2go/">doc2go</a>
      </small>
    </footer>
    <script src="../../../../_/js/permalink.js"></script></body>
</html>
